<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Loading data from a CSV file</title>
		<script type="text/javascript" src="../d3/d3.js"></script>
        <script type="text/javascript" src="../crossfilter/crossfilter.js"></script>
	</head>
	<body>
		<script type="text/javascript">

var dataset;
var oppts;
var so;
var opptCountBySO;
var topSO;

d3.tsv("querysample.tsv", function(error, data) {

        if (error) {  //If error is not null, something went wrong.
          console.log(error);  //Log the error.
        } else {      //If no error, the file loaded correctly. Yay!
          console.log(data);   //Log the data.

        //Include other code to execute after successful file load here
        dataset = data;
            
        oppts = crossfilter(dataset);
            
        console.log(oppts);
            
        so = oppts.dimension( function(d) { return d.SalesOffice; }),
            opptCountBySO = so.group(),
            topSO = opptCountBySO.top(5);

        }

});

		</script>
	</body>
</html>